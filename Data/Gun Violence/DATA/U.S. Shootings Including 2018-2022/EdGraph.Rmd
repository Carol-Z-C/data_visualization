---
title: "RMarkdown_Ed1"
author: "Edward Coleman"
date: '2022-06-17'
output:
  html_document: default
  word_document: default
---

## Setup
In this stage I am setting up my working directory and reading in the data set that I will be utilizing.
```{r setup}
setwd("C:/Users/ecole/Downloads/Ursinus/Data Sets/U.S. Shootings Including 2018-2022")
df <- read.csv("US Shootings Including 2018-2022 2.csv")
```

## Load the Functions
The next step is to load the functions that are going to analyze the data set and perform the graphs. They are saved in a different R Script file, so we have to read in the file name so that we are able to use the functions I have already created.

```{r}
source("EdGraph.R")
```

## Introduction
 In the wake of modern day mass shootings in the country, this project was created in order to find a connection between these horrible casualties and the COVID-19 global pandemic. Today, there are almost daily occurrences of mass shootings in the United States. A "mass shooting" is defined as an event caused by a shooter that results in four or more casualties. A majority of these shootings end up going unreported, but the ones that are reported receive nationwide news. The importance of this topic has increased in the recent months following the COVID-19 pandemic which may have a correlation to the way the country or each state responded to the pandemic - there has been a fluctuation of shootings in the country unfortunately. This may have to do with the mental illness of American citizens - which can be studied before, during, and after the pandemic. The pandemic had a major impact on the mental illness of Americans which will be discussed. The question is: how much did the country's response impact more violence and mass shootings to occur in the United States?

## Major Mass Shooting Tragedies
 Some of the shootings that have caught the nation's attention include the shootings at Sandy Hook Elementary School in 2012, the Parkland High School shooting in 2018, and of course the Columbine High School in 1999 that arguably set the stage for the debate on gun control in the country.
 
### Columbine High School (Littleton, Colorado) (1999): 
 The Columbine High School shooting took the world by a huge surprise - since there had never been any event similar to it in the past. Two teenagers killed 15 people, including themselves, and injured 20 others in the process. For 1999, this would be considered the worst school shooting in the country's history. Discussions about gun control and school safety and policies were brought up consistently after this event. This event unfortunately caused an increase in mass shootings in the country as well, specifically school shootings.
 
### Sandy Hook Elementary School (Newtown, Connecticut) (2012): 
 In December 2012, a 20 year old man shot up an elementary school in what would be known at the time as the second-deadliest mass shooting after the Virginia Tech massacre where 32 people were killed. The gunman even killed his mother beforehand as well. The mother was apparently the owner of the weapons used in the shooting. Some of the children killed were only 6 and 7 years old. The man went into two classrooms before killing himself - there were 12 first-grade survivers from the rooms. The state attorney stated that the shooter had a history of "significant mental health issues" and they "did not see anything that would have predicted his future behavior". New gun-safety protocols were attempted to be put into place by Barack Obama, however, the Senate blocked the bill proposed by him.
 
### Stoneman Douglas High School (Parkland, Florida) (2018): 
  In February 2018, 17 people were killed in the second deadliest high school shooting in the nation at the time in Parkland, Florida at Stoneman Douglas High School. The shooter was a previously expelled student from the school and had returned with automatic weapons he had purchased legally. The shooter successfully got off of the campus and even went to Subway and McDonald's before being detained. Many of the students who survived the attack took action against gun regulations and spoke out against corporations like the NRA who were protecting gun owners' rights instead of protecting the citizens of the nation. What came out of it was a bill that required a person to be 21 years old to legally buy a gun, there must be a three-day waiting period between all transaction, and - in some states - teachers or school staff were allowed to be armed with guns, which caused further debate.

### Connect with COVID and why this is important
  The COVID-19 pandemic took the world by storm in a similar way that the Columbine shooting did in 1999. The Columbine shooting ended up inspiring more active shooter training in public schools and stricter rules on the purchasing of guns. This changed the mindset of many citizens and voters - as the second amendment claims that all citizens have the right to bear arms. That amendment has been a key discussion point in the topic of mass shootings and has been brought up several times - mostly after a major shooting like the ones mentioned above. The COVID-19 pandemic also changed the world and how we view things as well. The world was used to going to school and knowing that they would be safe before the Columbine shooting. Now, the world is getting used to the idea of COVID-19 being a prominent disease in our lifetime. This is another obstacle for us to get over, but do these two events have any significant correlation? During the quarantine period, it seems as though there weren't as many shootings in the country as opposed to when the pandemic ended. Numbers for injuries and the number of people killed spiked around the June 2020 - July 2020 period when the Black Lives Matter Movement was at its climax. It seems as though as long as people aren't in quarantine, we are a danger to ourselves and to others if nothing is done about the gun situation in the country as you will see below.

## Results
Functions read-in from R Script file:

EdGraph1 & EdGraph2 - Both of these graphs utilize the same setup - the only difference is between the outputs "Number of Injuries" and "Number of People Killed". These graphs both use the same data set that describes some of the details of all shootings in America that classify as a "mass shooting" - four or more people being injured. We then use the data set to split the dates into Quarter years to make a less cluttered and clearer appearance for the graph. We then made a couple of times series so that we could make a dataset only containing the dates (quarters) along with either the number of people killed or the number of people injured. We then have to define in R each quarter and which months each of them represent.

EdGraph1 - This function graphs the number of injuries caused by mass shootings (per quarter/year).

EdGraph2 - This function graphs the number of people killed in a mass shooting (per quarter/year). 

EdGraph - This function combines the functions EdGraph1 and EdGraph 2 and forms an if-then statement. The function will print out EdGraph1() if either EdGraph(1) or EdGraph("Injured") are entered. If any other numbers or words are selected after EdGraph(), then EdGraph2() will automatically plot instead of EdGraph1().

The functions we defined can be used in the following ways:

### Example 1
```{r, warning=FALSE, message=FALSE}
library(dplyr)
library(tidyverse)
EdGraph(1)
```

  Using the above functions from the R Script file, we will graph the number of injuries caused by mass shootings. To visualize the data easier, we split the dates into Quarter/Year variables. For example, "Quarter 4 of 2018" is written as "2018 Q4".
  After splitting the data into different quarter-years, we create a legend and mark every Quarter with a specific shape that correlates to either "Quarter 1", "Quarter 2", "Quarter 3", and "Quarter 4". If we look at an individual shape on the graph, we can see that, we can follow the linear regression that occurs between each "Quarter 1", "Quarter 2", "Quarter 3", and "Quarter 4". For example, when looking at the linear regression of "Quarter 1", we will be looking at all the bars on the graph that have a black square on top.
  Judging by this graph, we can see that through a majority of the quarters, there is an increase in the number of injuries caused by mass shootings. We can see that in "2020 Q2", the number of injuries spiked - this was most likely due to the Black Lives Matter Movement mixed with the fact that a majority of people were coming out of quarantine at that time. The variable "2020 Q1" is probably lower than most of the other quarter/years because most people were quarantining due to the COVID-19 pandemic. The only decreases seen on the graph were between the quarters "2021 Q1" and "2022 Q2" (this was most likely due to the Omicron variant at the time) and "2021 Q2" and "2022 Q2" (this was most likely because we were still in this quarter, as we can see from the data collected).
  There seems to be a trend of more injuries due to mass shootings occurring specifically in Quarters 2 and 3. This being the middle of the year, this is also when people will become most active during the summertime - whereas Quarters 1 and 4 seem to have a trend of less injuries occurring - most likely because of them taking place during the wintertime.

### Example 2
```{r, warning=FALSE, message=FALSE}
EdGraph(2)
```

 Using the functions from before, we will graph the number of people killed in a mass shooting. Same as Example 1, we split the dates into Quarter/Year variables and assign individual shapes to "Quarter 1", "Quarter 2", "Quarter 3", and "Quarter 4" - using the same legend as before. For example, "Quarter 4 of 2018" is once again written as "2018 Q4". 
  Most of the linear regressions on this graph have an incline in the number of people killed in a mass shooting in a given quarter when comparing the quarters "2018 Q4" - "2022 Q2".
  Judging by this graph, we can see that through a majority of the quarters, there is an increase in the number of people killed during a mass shooting. The only decreases on the graph between quarters is between "2021 Q2" and "2022 Q2" (most likely because the data was still being collected for "2022 Q2"), between the quarters "2021 Q1" and "2022 Q1" (this is most likely because this is when the omicron variant was at some of its highest infection rates during "2022 Q1"), and between the quarters "2019 Q1" and "2020 Q1" (this was most likely because a majority of the country was in quarantine during "2020 Q1").
  There seems to be a clear increase of more fatalities due to mass shootings occurring after the COVID-19 pandemic. This may be because of the way the United States responded to the situation - quarantining its citizens and therefore angering them. During quarantine, numbers are much lower than previous quarters. After requiring people to isolate, the number of fatalities caused by mass shootings increase significantly.

### Example 3
```{r, warning=FALSE, message=FALSE}
EdGraph("Injured")
```

  Using the "If" statement from the R Script File sourced into this R Markdown, we are able to tell R to switch between two different graphs - one defining the number of injuries due to mass shootings quarterly in the U.S. and one defining the number of fatalities due to mass shootings quarterly in the United States. R can tell which graph to display by using the EdGraph() function and typing a number or name in place of the x input. If the x-input says "Injured" or the number "1", R will automatically display the graph with the number of injuries. Since here, "Injured" is put in place of x input, the number of injuries are shown quarterly.

### Example 4
```{r, warning=FALSE, message=FALSE}
EdGraph("Killed")
```

  Using the "If" statement from before, we are able to tell RMarkdown to switch between the two different graphs mentioned above. R can tell which graph to display by using the EdGraph() function and typing a number or name in place of the x input. If the x-input says anything other than "Injured" or the number "1", R will automatically display the graph with the number of fatalities caused by mass shootings quarterly in the United States. Since here, "Killed" is put in place of x input, the number of fatalities are shown quarterly.

### Example 5
```{r, warning=FALSE, message=FALSE}
EdGraph("Fatalities")
```

  Using the "If" statement from before, we are able to tell RMarkdown to switch between the two different graphs mentioned above. R can tell which graph to display by using the EdGraph() function and typing a number or name in place of the x input. If the x-input says anything other than "Injured" or the number "1", R will automatically display the graph with the number of fatalities caused by mass shootings quarterly in the United States. Since here, "Fatalities" is put in place of x input, the number of fatalities are shown quarterly.

### Example 6
```{r, warning=FALSE, message=FALSE}
EdGraph("Anything here")
```

  Using the "If" statement from before, we are able to tell RMarkdown to switch between the two different graphs mentioned above. R can tell which graph to display by using the EdGraph() function and typing a number or name in place of the x input. If the x-input says anything other than "Injured" or the number "1", R will automatically display the graph with the number of fatalities caused by mass shootings quarterly in the United States. Since here, "Anything here" is put in place of x input, the number of fatalities are shown quarterly.

